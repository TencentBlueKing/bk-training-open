(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{241:function(t,e,a){"use strict";var i=a(98);var r=a.n(i);var s=r.a},246:function(t,e,a){"use strict";var i=function(){var t=this;var e=t.$createElement;var a=t._self._c||e;return a("div",{staticClass:"body"},[a("div",{staticClass:"container"},[a("div",{staticClass:"left_container"},[a("bk-select",{staticStyle:{width:"190px",display:"inline-block"},attrs:{"ext-cls":"select-custom","ext-popover-cls":"select-popover-custom",searchable:""},on:{change:function(e){t.changeGroup(t.curGroupId)}},model:{value:t.curGroupId,callback:function(e){t.curGroupId=e},expression:"curGroupId"}},t._l(t.groupsData,function(t){return a("bk-option",{key:t.id,attrs:{id:t.id,name:t.name}})}),1),t._v(" "),a("bk-button",{staticClass:"mr10",staticStyle:{"margin-top":"-21px","margin-left":"5px"},attrs:{disabled:!t.isLeftContentWork,theme:"primary",type:"submit",title:"基础按钮"},on:{click:t.changeType}},[t._v("\n                "+t._s(t.isUser?"日期":"成员")+"\n            ")]),t._v(" "),a("div",{staticStyle:{"margin-top":"18px",height:"707px"}},[t.isUser?a("div",{staticClass:"users_list"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.isLeftContentWork,expression:"isLeftContentWork"}]},t._l(t.groupUsers,function(e){return a("bk-button",{key:e.id,staticClass:"mr10",staticStyle:{width:"130px"},attrs:{theme:e.id===t.curUserId?"primary":"default"},on:{click:function(a){t.changeDateOrUser(e.id,"")}}},[t._v("\n                            "+t._s(e.name)+"\n                        ")])}),1)]):a("div",{staticClass:"date_picker",staticStyle:{"margin-left":"0px"}},[a("bk-date-picker",{staticClass:"mr15",staticStyle:{position:"relative"},attrs:{disabled:!t.isLeftContentWork,format:"yyyy-MM-dd",placeholder:"选择日期",open:t.isLeftContentWork,"ext-popover-cls":"custom-popover-cls",options:t.customOption},on:{change:function(e){t.changeDateOrUser("",t.changeDate)}},model:{value:t.changeDate,callback:function(e){t.changeDate=e},expression:"changeDate"}})],1)]),t._v(" "),a("div",{staticStyle:{clear:"both"}})],1),t._v(" "),a("div",{staticClass:"right_container"},[!t.myTodayReport?a("div",{staticStyle:{"margin-bottom":"10px"}},[a("bk-alert",{attrs:{type:"warning",title:"警告的提示文字"}},[a("bk-link",{attrs:{slot:"title",theme:"warning",href:t.link},slot:"title"},[t._v("您当天未提交日报，可点击链接前往补签")])],1)],1):t._e(),t._v(" "),a("div",{staticClass:"report-tabs"},t._l(t.tabTitleList,function(e,i){return a("div",{key:i,class:{"header-tabs":true,"tabs-active":e===t.activeTabTitle},on:{click:function(a){t.changeTabs(e)}}},[t._v("\n                    "+t._s(e)+"\n                ")])}),0),t._v(" "),t.activeTabTitle===t.tabTitleList[0]?a("div",{staticClass:"all-report-wapper report-wapper"},[t.defaultPaging.count===0?a("div",{staticClass:"all-empty"},[t._v("\n                    没有日报内容哟~\n                ")]):t._e(),t._v(" "),a("div",{staticClass:"all-report-body"},t._l(t.dailysData.dailys,function(e,i){return a("bk-card",{key:i,staticClass:"all-report-card card",attrs:{title:e.create_by+"("+e.create_name+")"+"-"+"日报"}},[a("div",[t._v("日期："+t._s(e.date))]),t._v(" "),a("div",[t._v("日报状态："+t._s(e.send_describe))]),t._v(" "),t._l(e.content,function(i,r){return a("div",{key:r},[a("h4",[t._v(t._s(i.title))]),t._v(" "),i.type==="table"?a("div",{staticStyle:{"font-size":"18px"}},t._l(i.content,function(i,r){return a("div",{key:r},[a("pre",[t._v(t._s(r+1)+"."+t._s(i.text))]),t.curUserName===e.create_by||!i.isPrivate?a("span",[t._v("----("+t._s(i.cost)+")")]):t._e()])}),0):a("div",[t._v("\n                                "+t._s(i.text)+"\n                            ")])])})],2)}),1),t._v(" "),a("bk-pagination",{attrs:{"ext-cls":"bottom-paging","show-total-count":"true",current:t.defaultPaging.current,count:t.defaultPaging.count,limit:t.defaultPaging.limit,"limit-list":t.defaultPaging.limitList},on:{change:t.changePage,"limit-change":t.changeLimit,"update:current":function(e){t.$set(t.defaultPaging,"current",e)},"update:count":function(e){t.$set(t.defaultPaging,"count",e)}}})],1):a("div",{staticClass:"perfect-report-wapper report-wapper"},[a("div",{staticClass:"right-top-bar"},[a("div",{staticClass:"select-bar"},[a("bk-select",{staticStyle:{width:"150px"},attrs:{disabled:false,"ext-cls":"select-type",behavior:"simplicity",placeholder:"请选择查看类型","ext-popover-cls":"select-popover-perfect",placement:"bottom-end"},on:{change:t.changeShowType},model:{value:t.perfectShowType,callback:function(e){t.perfectShowType=e},expression:"perfectShowType"}},t._l(t.pecfectTypeList,function(t){return a("bk-option",{key:t.id,attrs:{id:t.id,name:t.name}})}),1)],1),t._v(" "),a("bk-date-picker",{attrs:{disabled:t.perfectSetting.perfectShowType===1,behavior:"simplicity",type:t.perfectSetting.DateSelectType,format:t.perfectSetting.DateType,"ext-cls":"perfect-date-picker",placeholder:"选择日期"},on:{change:t.perfectDateChange},model:{value:t.perfectDate,callback:function(e){t.perfectDate=e},expression:"perfectDate"}})],1),t._v(" "),a("div",{staticClass:"perfect-body"},[t.perfectPaging.count===0?a("div",{staticClass:"perfect-empty"},[t._v("\n                        没有日报内容哟~\n                    ")]):t._e(),t._v(" "),a("div",{staticClass:"perfect-cards"},t._l(t.perfectDailysData.daily_list,function(e,i){return a("bk-card",{key:i,staticClass:"perfect-report-card card",attrs:{title:e.create_by+"("+e.create_name+")"+"-"+"日报"}},[a("div",[t._v("日期："+t._s(e.date))]),t._v(" "),a("div",[t._v("日报状态："+t._s(e.send_describe))]),t._v(" "),t._l(e.content,function(i,r){return a("div",{key:r},[a("h4",[t._v(t._s(i.title))]),t._v(" "),i.type==="table"?a("div",{staticStyle:{"font-size":"18px"}},t._l(i.content,function(i,r){return a("div",{key:r},[a("pre",{staticClass:"card-pre"},[t._v("("+t._s(r+1)+")"+t._s(i.text))]),t.curUserName===e.create_by||!i.isPrivate?a("span",[t._v("----("+t._s(i.cost)+")")]):t._e()])}),0):a("div",[t._v("\n                                    "+t._s(i.text)+"\n                                ")])])})],2)}),1)]),t._v(" "),a("bk-pagination",{attrs:{"ext-cls":"bottom-paging","show-total-count":"true",current:t.perfectPaging.current,count:t.perfectPaging.count,limit:t.perfectPaging.limit,"limit-list":t.perfectPaging.limitList},on:{change:t.changePerfectPage,"limit-change":t.changePerfectLimit,"update:current":function(e){t.$set(t.perfectPaging,"current",e)},"update:count":function(e){t.$set(t.perfectPaging,"count",e)}}})],1),t._v(" "),a("div",{staticStyle:{clear:"both"}})]),t._v(" "),a("div",{staticStyle:{clear:"both"}})])])};var r=[];a.d(e,"a",function(){return i});a.d(e,"b",function(){return r})},84:function(t,e,a){"use strict";a.r(e);var i=a(246);var r=a(96);for(var s in r)if(s!=="default")(function(t){a.d(e,t,function(){return r[t]})})(s);var n=a(241);var c=a(3);var o=Object(c["a"])(r["default"],i["a"],i["b"],false,null,"21bd55ce",null);e["default"]=o.exports},96:function(t,e,a){"use strict";a.r(e);var i=a(97);var r=a.n(i);for(var s in i)if(s!=="default")(function(t){a.d(e,t,function(){return i[t]})})(s);e["default"]=r.a},97:function(t,e,a){"use strict";var i=a(0);Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;a(29);a(85);var r=i(a(108));var s=i(a(236));var n=i(a(237));var c=i(a(86));var o=i(a(92));var u={components:{bkPagination:c.default,bkSelect:n.default,bkOption:s.default,bkDatePicker:r.default},data:function t(){return{myTodayReport:true,defaultPaging:{current:1,limit:8,count:0,limitList:[8,16,32,64]},groupsData:[],curGroupId:null,curGroup:{id:"",name:"",admin:[],create_by:"",create_name:"",create_time:""},customOption:{disabledDate:function t(e){if(e>new Date){return true}}},isUser:false,curDate:(0,o.default)(new Date).format("YYYY-MM-DD"),dailysData:{count:100,dailys:[]},groupUsers:[],curUserId:null,curUserName:this.$store.state.user.username,tabTitleList:["所有日报","优秀日报"],activeTabTitle:"所有日报",pecfectTypeList:[{id:1,name:"全部"},{id:2,name:"按月"}],perfectDate:new Date,perfectSetting:{perfectShowType:1,DateType:"yyyy-MM",DateSelectType:"month"},perfectPaging:{current:1,limit:8,count:0,limitList:[8,16,32,64]},perfectDailysData:{daily_list:[]},isLeftContentWork:true}},computed:{link:function t(){return window.PROJECT_CONFIG.SITE_URL+"home?date="+this.curDate}},created:function t(){var e=this.$route.query.group;if(e!==undefined){this.curGroupId=parseInt(e)}},activated:function t(){if(!this.groupsData.length){this.init()}else{this.getDailys()}},methods:{changeLimit:function t(e){this.defaultPaging.limit=e;if(this.curUserId===""&&this.curDate===""){this.curDate=(0,o.default)(new Date).format("YYYY-MM-DD")}this.getDailys()},changePage:function t(e){this.defaultPaging.current=e;if(this.curUserId===""&&this.curDate===""){this.curDate=(0,o.default)(new Date).format("YYYY-MM-DD")}this.getDailys()},changeType:function t(){this.myTodayReport=true;this.isUser=!this.isUser;if(!this.isUser){this.changeGroup(this.curGroupId)}},getGroupUsers:function t(e){var a=this;this.$http.get("/get_group_users/"+e+"/").then(function(t){if(t.result){a.groupUsers=[];if(t.data.length!==0&&t.data.length!==null){t.data.map(function(t,e){if(t.username!=="admin"){a.groupUsers.push(t)}})}}else{a.$bkMessage({offsetY:80,delay:2e3,theme:"error",message:t.message})}})},changeDateOrUser:function t(e,a){this.curDate=a===""?"":(0,o.default)(a).format("YYYY-MM-DD");this.curUserId=e;if(this.curUserId===""&&this.curDate===""){this.curDate=(0,o.default)(new Date).format("YYYY-MM-DD")}this.getDailys()},getDailys:function t(){var e=this;if(!this.curGroupId){return}this.$http.get("/report_filter/"+this.curGroupId+"/?date="+this.curDate+"&member_id="+this.curUserId+"&size="+this.defaultPaging.limit+"&page="+this.defaultPaging.current).then(function(t){if(t.result){e.defaultPaging.count=t.data.total_report_num;e.dailysData.dailys=t.data.reports;if(t.data.my_today_report!==undefined){e.myTodayReport=t.data.my_today_report}else{e.myTodayReport=true}if(e.isUser){e.myTodayReport=true}}else{var a={message:t.message,offsetY:80,theme:"error"};e.$bkMessage(a)}})},init:function t(){var e=this;this.$http.get("/get_user_groups/").then(function(t){e.groupsData=t.data;if(!e.groupsData||e.groupsData.length===0){e.$router.push({name:"MyGroup"})}if(e.groupsData.length!==0&&e.groupsData.length!==undefined){if(e.curGroupId!==null){var a=e;e.groupsData.forEach(function(t){if(t.id===a.curGroupId){a.curGroup=t;a.getGroupUsers(a.curGroupId);a.changeDateOrUser("",a.curDate)}})}else{e.curGroupId=e.groupsData[0].id;e.curGroup=e.groupsData[0]}}})},changeGroup:function t(e){if(e===null||e===""){this.curGroup={id:"",name:"",admin:[],create_by:"",create_name:"",create_time:""};this.groupUsers=[];this.curUserId=null;this.dailysData.dailys=[]}else{var a=this;this.groupsData.forEach(function(t){if(t.id===e){a.curGroup=t}});this.getGroupUsers(e);this.isUser=false;this.changeDateOrUser("",new Date);this.getPerfectReport()}},changeShowType:function t(e,a){this.perfectSetting.perfectShowType=e;if(this.pecfectTypeList[e-1].name==="按月"){this.perfectSetting.DateType="yyyy-MM";this.perfectSetting.DateSelectType="month"}else if(this.pecfectTypeList[e-1].name==="全部"){this.getPerfectReport()}},getPerfectReport:function t(){var e=this;var a=this.perfectSetting.perfectShowType===1?"all":"month";this.$http.get("/get_prefect_dailys/"+this.curGroupId+"/?select_type="+a+"&page="+this.perfectPaging.current+"&size="+this.perfectPaging.limit+"&year="+(0,o.default)(this.perfectDate).format("YYYY")+"&month="+(0,o.default)(this.perfectDate).format("MM")).then(function(t){if(t.result){e.perfectDailysData=t.data;e.perfectPaging.count=t.data.total_num}else{e.$bkMessage({offsetY:80,delay:2e3,theme:"warning",message:t.message})}})},perfectDateChange:function t(e,a){this.getPerfectReport()},changePerfectLimit:function t(e){this.perfectPaging.limit=e;this.getPerfectReport()},changePerfectPage:function t(e){this.perfectPaging.current=e;this.getPerfectReport()},changeTabs:function t(e){this.activeTabTitle=e;this.isLeftContentWork=e!=="优秀日报"}}};e.default=u},98:function(t,e,a){}}]);