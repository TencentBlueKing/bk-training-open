(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{232:function(e,t,a){"use strict";var i=a(94);var r=a.n(i);var s=r.a},237:function(e,t,a){"use strict";var i=function(){var e=this;var t=e.$createElement;var a=e._self._c||t;return a("div",{attrs:{id:"myGroup"}},[a("div",{staticClass:"body"},[a("div",{staticClass:"line-container group-info",staticStyle:{"margin-top":"30px"}},[a("bk-divider",{attrs:{align:"left"}},[a("div",{staticClass:"container-label"},[e._v("基本信息")])]),e._v(" "),a("span",{staticStyle:{float:"left","margin-top":"12px","margin-left":"21px"}},[e._v("组名：")]),e._v(" "),a("bk-select",{staticStyle:{width:"250px","margin-top":"10px",display:"inline-block"},attrs:{disabled:false,"ext-cls":"select-custom","ext-popover-cls":"select-popover-custom",searchable:""},on:{change:function(t){e.changeGroup(e.curGroupId)}},model:{value:e.curGroupId,callback:function(t){e.curGroupId=t},expression:"curGroupId"}},e._l(e.groupsData,function(e){return a("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})}),1),e._v(" "),a("bk-button",{staticClass:"mr10",staticStyle:{"margin-left":"30px","margin-top":"-20px"},attrs:{theme:"primary"},on:{click:function(t){e.addGroupDialog.visible=true}}},[e._v("\n                +新增组\n            ")]),e._v(" "),a("bk-dialog",{staticClass:"add-group-dialog",attrs:{theme:"primary",title:"新增组","show-footer":false},model:{value:e.addGroupDialog.visible,callback:function(t){e.$set(e.addGroupDialog,"visible",t)},expression:"addGroupDialog.visible"}},[a("bk-form",{attrs:{"label-width":"120"}},[a("bk-form-item",{attrs:{label:"组名称",required:"true"}},[a("bk-input",{model:{value:e.addGroupData.formData.name,callback:function(t){e.$set(e.addGroupData.formData,"name",t)},expression:"addGroupData.formData.name"}})],1),e._v(" "),a("bk-form-item",{attrs:{label:"管理员",required:"true"}},[a("bk-select",{staticStyle:{width:"250px","margin-top":"10px"},attrs:{searchable:"",multiple:"","display-tag":""},model:{value:e.addGroupData.adminIds,callback:function(t){e.$set(e.addGroupData,"adminIds",t)},expression:"addGroupData.adminIds"}},e._l(e.bkUsers,function(e){return a("bk-option",{key:e.id,attrs:{id:e.id,name:e.username+"("+e.display_name+")"}})}),1)],1),e._v(" "),a("bk-form-item",[a("bk-button",{staticStyle:{"margin-left":"20px","margin-right":"40px"},attrs:{theme:"primary",title:"提交"},on:{click:function(t){t.stopPropagation();t.preventDefault();return e.addGroup(t)}}},[e._v("提交")]),e._v(" "),a("bk-button",{attrs:{"ext-cls":"mr5",theme:"default",title:"取消"},on:{click:function(t){e.addGroupDialog.visible=false}}},[e._v("取消")])],1)],1)],1),e._v(" "),a("bk-button",{directives:[{name:"show",rawName:"v-show",value:e.curUser.isAdmin,expression:"curUser.isAdmin"}],ref:"adminClick",staticClass:"mr10",staticStyle:{"margin-top":"-20px"},attrs:{disabled:!e.curUser.isAdmin,theme:"primary",title:"主要按钮"},on:{click:e.clickEditGroup}},[e._v("\n                编辑组\n            ")]),e._v(" "),a("bk-dialog",{staticClass:"add-group-dialog",attrs:{theme:"primary",title:"修改组信息","show-footer":false},model:{value:e.editGroupDialog.visible,callback:function(t){e.$set(e.editGroupDialog,"visible",t)},expression:"editGroupDialog.visible"}},[a("bk-form",{attrs:{"label-width":"120"}},[a("bk-form-item",{attrs:{label:"组名称",required:"true"}},[a("bk-input",{model:{value:e.editGroupData.formData.name,callback:function(t){e.$set(e.editGroupData.formData,"name",t)},expression:"editGroupData.formData.name"}})],1),e._v(" "),a("bk-form-item",{attrs:{label:"管理员",required:"true"}},[a("bk-select",{staticStyle:{width:"250px","margin-top":"10px"},attrs:{searchable:"",multiple:"","display-tag":""},model:{value:e.editGroupData.adminIds,callback:function(t){e.$set(e.editGroupData,"adminIds",t)},expression:"editGroupData.adminIds"}},e._l(e.bkUsers,function(e){return a("bk-option",{key:e.id,attrs:{id:e.id,name:e.username+"("+e.display_name+")"}})}),1)],1),e._v(" "),a("bk-form-item",[a("bk-button",{staticStyle:{"margin-left":"20px","margin-right":"40px"},attrs:{theme:"primary",title:"提交"},on:{click:function(t){t.stopPropagation();t.preventDefault();e.editGroup(e.curGroupId)}}},[e._v("提交")]),e._v(" "),a("bk-button",{attrs:{"ext-cls":"mr5",theme:"default",title:"取消"},on:{click:function(t){e.editGroupDialog.visible=false}}},[e._v("取消")])],1)],1)],1),e._v(" "),a("bk-button",{directives:[{name:"show",rawName:"v-show",value:e.curUser.isAdmin,expression:"curUser.isAdmin"}],staticClass:"mr10",staticStyle:{"margin-top":"-20px"},attrs:{disabled:!e.curUser.isAdmin,theme:"primary",title:"主要按钮"},on:{click:function(t){e.deleteGroupDialog.visible=true}}},[e._v("\n                删除组\n            ")]),e._v(" "),a("bk-dialog",{staticClass:"delete-group-dialog",attrs:{theme:"primary","show-footer":false},model:{value:e.deleteGroupDialog.visible,callback:function(t){e.$set(e.deleteGroupDialog,"visible",t)},expression:"deleteGroupDialog.visible"}},[a("bk-form",{attrs:{"label-width":"80"}},[a("bk-form-item",{staticStyle:{"margin-left":"15px"}},[e._v("\n                        确认删除"+e._s(e.curGroup.name)+"吗？\n                    ")]),e._v(" "),a("bk-form-item",[a("bk-button",{staticStyle:{"margin-left":"20px","margin-right":"20px"},attrs:{theme:"primary",title:"提交"},on:{click:function(t){t.stopPropagation();t.preventDefault();return e.deleteGroup(t)}}},[e._v("提交")]),e._v(" "),a("bk-button",{attrs:{"ext-cls":"mr5",theme:"default",title:"取消"},on:{click:function(t){e.deleteGroupDialog.visible=false}}},[e._v("取消")])],1)],1)],1),e._v(" "),a("bk-button",{staticClass:"mr10",staticStyle:{"margin-top":"-20px"},attrs:{theme:"primary",title:"主要按钮"},on:{click:function(t){e.showApplyForGroup()}}},[e._v("\n                申请入组\n            ")]),e._v(" "),a("bk-dialog",{staticClass:"apply-join-club-dialog",attrs:{theme:"primary","show-footer":false},model:{value:e.applyForGroup.dialogVisible,callback:function(t){e.$set(e.applyForGroup,"dialogVisible",t)},expression:"applyForGroup.dialogVisible"}},[a("bk-form",{attrs:{"label-width":"80"}},[a("bk-form-item",{attrs:{label:"组",required:"true"}},[a("bk-select",{staticStyle:{width:"250px"},attrs:{loading:e.availableGroupsIsLoding,searchable:""},model:{value:e.applyForGroup.groupId,callback:function(t){e.$set(e.applyForGroup,"groupId",t)},expression:"applyForGroup.groupId"}},e._l(e.availableApplyGroups,function(e){return a("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})}),1)],1),e._v(" "),a("bk-form-item",[a("bk-button",{staticStyle:{"margin-left":"20px","margin-right":"40px"},attrs:{theme:"primary",disabled:e.applyForGroup.groupId==="",title:"提交"},on:{click:function(t){t.stopPropagation();t.preventDefault();e.doApplyforGroup()}}},[e._v("提交")]),e._v(" "),a("bk-button",{attrs:{"ext-cls":"mr5",theme:"default",title:"取消"},on:{click:function(t){e.applyForGroup.dialogVisible=false}}},[e._v("取消")])],1)],1)],1),e._v(" "),a("div",{staticStyle:{height:"30px","margin-top":"6px","margin-left":"18px"}},[e._v("管理员："),e._l(e.curGroup.admin_list,function(t){return a("span",{key:t.id},[e._v(e._s(t.username)+"("+e._s(t.name)+"); ")])})],2),e._v(" "),a("div",{staticStyle:{height:"30px","margin-top":"6px","margin-left":"18px"}},[e._v("创建人："),e.curGroupId!==null?a("span",[e._v(e._s(e.curGroup.create_by)+"("+e._s(e.curGroup.create_name)+")")]):e._e()]),e._v(" "),a("div",{staticStyle:{height:"30px","margin-top":"6px","margin-left":"18px"}},[e._v("创建时间："+e._s(e.curGroup.create_time))])],1),e._v(" "),a("div",{staticClass:"line-container daily-template-info",staticStyle:{"margin-top":"0px"}},[a("bk-card",{attrs:{title:"日报模板"}},[a("bk-link",{directives:[{name:"show",rawName:"v-show",value:e.curUser.isAdmin,expression:"curUser.isAdmin"}],staticStyle:{display:"float"},attrs:{disabled:!e.curUser.isAdmin,theme:"primary"},on:{click:function(t){e.addDailyTemplateDialog.visible=true}}},[e._v("+新增模板")]),e._v(" "),a("bk-dialog",{staticClass:"add-group-dialog",attrs:{theme:"primary",title:"新增模板","show-footer":false},model:{value:e.addDailyTemplateDialog.visible,callback:function(t){e.$set(e.addDailyTemplateDialog,"visible",t)},expression:"addDailyTemplateDialog.visible"}},[a("bk-form",{attrs:{"label-width":"120"}},[a("bk-form-item",{attrs:{label:"模板名称",required:"true"}},[a("bk-input",{model:{value:e.addDailyTemplateData.formData.name,callback:function(t){e.$set(e.addDailyTemplateData.formData,"name",t)},expression:"addDailyTemplateData.formData.name"}})],1),e._v(" "),a("bk-form-item",{attrs:{label:"模板内容",required:"true"}},[a("bk-input",{attrs:{type:"textarea",placeholder:"例如：今日任务;明日计划;总结"},model:{value:e.addDailyTemplateData.formData.content,callback:function(t){e.$set(e.addDailyTemplateData.formData,"content",t)},expression:"addDailyTemplateData.formData.content"}})],1),e._v(" "),a("bk-form-item",[a("bk-button",{staticStyle:{"margin-left":"20px","margin-right":"40px"},attrs:{theme:"primary",title:"提交"},on:{click:function(t){t.stopPropagation();t.preventDefault();return e.addDailyTemplate(t)}}},[e._v("提交")]),e._v(" "),a("bk-button",{attrs:{"ext-cls":"mr5",theme:"default",title:"取消"},on:{click:function(t){e.addDailyTemplateDialog.visible=false}}},[e._v("取消")])],1)],1)],1),e._v(" "),a("bk-table",{staticStyle:{"margin-top":"10px"},attrs:{height:"210px",data:e.dailyTemplates,size:e.size,pagination:e.pagination,"virtual-render":true},on:{"row-mouse-enter":e.handleRowMouseEnter,"row-mouse-leave":e.handleRowMouseLeave,"page-change":e.handlePageChange,"page-limit-change":e.handlePageLimitChange}},[a("bk-table-column",{attrs:{type:"index",label:"序列",width:"100"}}),e._v(" "),a("bk-table-column",{attrs:{label:"模板名称",prop:"name",width:"320"}}),e._v(" "),a("bk-table-column",{attrs:{label:"模板内容",prop:"content"}}),e._v(" "),a("bk-table-column",{attrs:{label:"创建人",prop:"create_by"}}),e._v(" "),a("bk-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("bk-button",{directives:[{name:"show",rawName:"v-show",value:e.curUser.isAdmin,expression:"curUser.isAdmin"}],staticClass:"mr10",attrs:{theme:"primary",text:"",disabled:!e.curUser.isAdmin},on:{click:function(a){e.clickEditDailyTemplate(t.row)}}},[e._v("修改")]),e._v(" "),a("bk-button",{directives:[{name:"show",rawName:"v-show",value:e.curUser.isAdmin,expression:"curUser.isAdmin"}],staticClass:"mr10",attrs:{theme:"primary",text:"",disabled:!e.curUser.isAdmin},on:{click:function(a){e.removeDailyTemplate(t.row)}}},[e._v("移除")]),e._v(" "),a("bk-dialog",{staticClass:"add-group-dialog",attrs:{theme:"primary",title:"修改模板","show-footer":false},model:{value:e.editDailyTemplateDialog.visible,callback:function(t){e.$set(e.editDailyTemplateDialog,"visible",t)},expression:"editDailyTemplateDialog.visible"}},[a("bk-form",{attrs:{"label-width":"120"}},[a("bk-form-item",{attrs:{label:"模板名称",required:"true"}},[a("bk-input",{model:{value:e.editDailyTemplateData.formData.name,callback:function(t){e.$set(e.editDailyTemplateData.formData,"name",t)},expression:"editDailyTemplateData.formData.name"}})],1),e._v(" "),a("bk-form-item",{attrs:{label:"模板内容",required:"true"}},[a("bk-input",{attrs:{type:"textarea",placeholder:"请输入描述"},model:{value:e.editDailyTemplateData.formData.content,callback:function(t){e.$set(e.editDailyTemplateData.formData,"content",t)},expression:"editDailyTemplateData.formData.content"}})],1),e._v(" "),a("bk-form-item",[a("bk-button",{staticStyle:{"margin-left":"20px","margin-right":"40px"},attrs:{theme:"primary",title:"提交"},on:{click:function(t){t.stopPropagation();t.preventDefault();return e.editDailyTemplate(t)}}},[e._v("提交")]),e._v(" "),a("bk-button",{attrs:{"ext-cls":"mr5",theme:"default",title:"取消"},on:{click:function(t){e.editDailyTemplateDialog.visible=false}}},[e._v("取消")])],1)],1)],1)]}}])})],1)],1)],1),e._v(" "),a("div",{staticClass:"line-container group-users"},[a("bk-card",{attrs:{title:"组内成员"}},[a("bk-link",{directives:[{name:"show",rawName:"v-show",value:e.curUser.isAdmin,expression:"curUser.isAdmin"}],attrs:{disabled:!e.curUser.isAdmin,theme:"primary"},on:{click:e.clickAddUser}},[e._v("+新增成员")]),e._v(" "),a("bk-dialog",{staticClass:"add-group-dialog",attrs:{theme:"primary",title:"添加成员","show-footer":false},model:{value:e.addUserDialog.visible,callback:function(t){e.$set(e.addUserDialog,"visible",t)},expression:"addUserDialog.visible"}},[a("bk-form",{attrs:{"label-width":"120"}},[a("bk-form-item",{attrs:{label:"成员",required:"true"}},[a("bk-select",{staticStyle:{width:"250px"},attrs:{disabled:false,"ext-cls":"select-custom","ext-popover-cls":"select-popover-custom",searchable:""},model:{value:e.addUserForm.id,callback:function(t){e.$set(e.addUserForm,"id",t)},expression:"addUserForm.id"}},e._l(e.bkUsers,function(e){return a("bk-option",{key:e.id,attrs:{id:e.id,name:e.username+"("+e.display_name+")"}})}),1)],1),e._v(" "),a("bk-form-item",[a("bk-button",{staticStyle:{"margin-left":"20px","margin-right":"40px"},attrs:{theme:"primary",title:"提交"},on:{click:function(t){t.stopPropagation();t.preventDefault();return e.addUser(t)}}},[e._v("提交")]),e._v(" "),a("bk-button",{attrs:{"ext-cls":"mr5",theme:"default",title:"取消"},on:{click:function(t){e.addUserDialog.visible=false}}},[e._v("取消")])],1)],1)],1),e._v(" "),a("bk-table",{staticStyle:{"margin-top":"15px"},attrs:{height:"212px",data:e.groupUsers,size:e.size,pagination:e.pagination,"virtual-render":true},on:{"row-mouse-enter":e.handleRowMouseEnter,"row-mouse-leave":e.handleRowMouseLeave,"page-change":e.handlePageChange,"page-limit-change":e.handlePageLimitChange}},[a("bk-table-column",{attrs:{type:"index",label:"序列",width:"100"}}),e._v(" "),a("bk-table-column",{attrs:{label:"用户名",prop:"username"}}),e._v(" "),a("bk-table-column",{attrs:{label:"姓名",prop:"name"}}),e._v(" "),a("bk-table-column",{attrs:{label:"电话",prop:"phone"}}),e._v(" "),a("bk-table-column",{attrs:{label:"邮箱",prop:"email"}}),e._v(" "),a("bk-table-column",{attrs:{label:"操作",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("bk-button",{directives:[{name:"show",rawName:"v-show",value:e.curUser.isAdmin,expression:"curUser.isAdmin "}],staticClass:"mr10",attrs:{disabled:e.curGroup.admin.indexOf(t.row.username)!==-1,theme:"primary",text:""},on:{click:function(a){e.removeUser(t.row)}}},[e._v("移除")])]}}])})],1)],1)],1)])])};var r=[];a.d(t,"a",function(){return i});a.d(t,"b",function(){return r})},78:function(e,t,a){"use strict";a.r(t);var i=a(237);var r=a(92);for(var s in r)if(s!=="default")(function(e){a.d(t,e,function(){return r[e]})})(s);var o=a(232);var l=a(2);var n=Object(l["a"])(r["default"],i["a"],i["b"],false,null,"334559ce",null);t["default"]=n.exports},92:function(e,t,a){"use strict";a.r(t);var i=a(93);var r=a.n(i);for(var s in i)if(s!=="default")(function(e){a.d(t,e,function(){return i[e]})})(s);t["default"]=r.a},93:function(e,t,a){"use strict";var i=a(0);Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;a(29);a(79);var r=i(a(80));var s=i(a(81));var o={name:"",components:{bkSelect:s.default,bkOption:r.default},data:function e(){return{curUser:{isAdmin:false,info:{id:"",username:""}},groupsData:[],curGroupId:null,curGroup:{id:"",name:"",admin:"",admin_list:[],create_by:"",create_name:"",create_time:""},bkUsers:[],addGroupDialog:{visible:false},addGroupData:{adminIds:[],formData:{name:"",admin:[]}},editGroupDialog:{visible:false},editGroupData:{adminIds:[],formData:{name:"",admin:[]}},deleteGroupDialog:{visible:false},availableApplyGroups:[],availableGroupsIsLoding:true,applyForGroup:{dialogVisible:false,groupId:""},addDailyTemplateDialog:{visible:false},addDailyTemplateData:{formData:{name:"",content:""}},dailyTemplates:[],editDailyTemplateDialog:{visible:false},editDailyTemplateData:{formData:{template_id:"",name:"",content:""}},groupUsers:[],addUserDialog:{visible:false},addUserForm:{id:"",username:"",name:"",phone:"",email:""}}},created:function e(){this.init()},mounted:function e(){this.getAllBKUser()},methods:{getAllBKUser:function e(){var t=this;this.$http.get("/get_all_bk_users/").then(function(e){t.bkUsers=e.data.results;console.log("bkUsers",t.bkUsers)})},getGroupInfo:function e(t){var a=this;this.$http.get("/get_group_info/"+t+"/").then(function(e){a.curGroup=e.data;console.log("curGroup",a.curGroup);a.curUser.isAdmin=false;if(a.curGroup.admin.indexOf(a.curUser.info.username)!==-1){a.curUser.isAdmin=true}console.log("isAdmin",a.curUser.isAdmin)})},getGroupUsers:function e(t){var a=this;this.$http.get("/get_group_users/"+t+"/").then(function(e){a.groupUsers=e.data;console.log("get_group_users:",e.data)})},getAvailableApplyGroups:function e(){var t=this;this.availableGroupsIsLoding=true;this.$http.get("/get_available_apply_groups/").then(function(e){t.availableApplyGroups=e.data;if(t.availableApplyGroups.length>0){t.applyForGroup.groupId=t.availableApplyGroups[0].id}}).finally(function(){t.availableGroupsIsLoding=false})},getGroupTemplates:function e(t){var a=this;this.$http.get("/report_template/"+t+"/").then(function(e){a.dailyTemplates=e.data;console.log("get_report_templates:",e.data)})},changeGroup:function e(t){if(t===""||t===null){console.log("点x");this.curGroupId=null;this.curGroup={id:"",name:"",admin:"",admin_list:[],create_by:"",create_name:"",create_time:""};this.dailyTemplates=[];this.groupUsers=[];this.curUser.isAdmin=false}else{this.getGroupInfo(t);this.getGroupUsers(t);this.getGroupTemplates(t)}},clickAddUser:function e(){this.addUserDialog.visible=true;this.addUserForm.id=this.bkUsers[0].id;console.log("bk-first-userId:",this.addUserForm.id)},clickEditGroup:function e(){this.editGroupDialog.visible=true;this.editGroupData.formData.name=this.curGroup.name;var t=[];var a=this;console.log("curGroupAdmin",a.curGroup.admin);console.log(a.curGroup.admin);this.bkUsers.forEach(function(e){if(a.curGroup.admin.indexOf(e.username)!==-1){t.push(e.id)}});this.editGroupData.adminIds=t;console.log("curGroupAdminIds",this.editGroupData.adminIds)},showApplyForGroup:function e(){this.applyForGroup.dialogVisible=true;this.getAvailableApplyGroups()},clickEditDailyTemplate:function e(t){this.editDailyTemplateDialog.visible=true;this.editDailyTemplateData.formData={template_id:t.id,name:t.name,content:t.content}},init:function e(){var t=this;this.$http.get("/get_user/").then(function(e){t.curUser.info=e.data;console.log("curUser",t.curUser.info);t.$http.get("/get_user_groups/").then(function(e){t.groupsData=e.data;console.log("init_group, groupsData:",t.groupsData);if(t.groupsData.length!==0){t.curGroupId=t.groupsData[0].id;t.changeGroup(t.curGroupId)}})})},addGroup:function e(){var t=this;var a=this;var i=[];this.bkUsers.forEach(function(e){if(a.addGroupData.adminIds.indexOf(e.id)!==-1){i.push(e)}});if(this.addGroupData.adminIds.indexOf(this.curUser.info.id)===-1){var r=false;var s=this;this.bkUsers.forEach(function(e){if(s.curUser.info.username===e.username){i.push(e);r=true}});console.log("hasUser",r);if(!r){var o={};o.message="未在蓝鲸用户平台找到登录用户信息";o.offsetY=80;o.theme="error";this.$bkMessage(o);return}}this.addGroupData.formData.admin=i;console.log("参数formData",this.addGroupData.formData);this.$http.post("/add_group/",this.addGroupData.formData).then(function(e){var a={};a.offsetY=80;a.message=e.message;if(e.result){a.theme="success";t.$bkMessage(a);console.log("新建组id",e.data.group_id);t.$http.get("/get_user_groups/").then(function(a){t.groupsData=a.data;console.log("init_groups, allGroupsData:",t.groupsData);t.curGroupId=e.data.group_id;t.changeGroup(t.curGroupId);t.addGroupDialog.visible=false;t.addGroupData.formData.name="";t.addGroupData.adminIds=[]})}else{a.theme="error";t.$bkMessage(a)}})},editGroup:function e(t){var a=this;var i=this;var r=[];this.bkUsers.forEach(function(e){if(i.editGroupData.adminIds.indexOf(e.id)!==-1){r.push(e)}});this.editGroupData.formData.admin=r;console.log("editGroup-formData",this.editGroupData.formData);this.$http.post("/update_group/"+t+"/",this.editGroupData.formData).then(function(e){var i={};i.offsetY=80;if(e.result){i.message=e.message;i.theme="success";a.$bkMessage(i);a.$http.get("/get_user_groups/").then(function(e){a.groupsData=e.data;a.changeGroup(t);a.editGroupDialog.visible=false})}else{i.message=e.message;i.theme="error";a.$bkMessage(i)}})},deleteGroup:function e(){var t=this;console.log("clickDeleteGroup,groupId:",this.curGroupId);this.$http.post("/delete_group/"+this.curGroupId+"/").then(function(e){var a={};a.offsetY=80;if(e.result){a.message=e.message;a.theme="success";t.$bkMessage(a);t.deleteGroupDialog.visible=false;t.curGroupId=null;t.curGroup={id:"",name:"",admin:"",admin_list:[],create_by:"",create_name:"",create_time:""};t.dailyTemplates=[];t.groupUsers=[];t.curUser.isAdmin=false;t.init()}else{a.message=e.message;a.theme="error";t.$bkMessage(a)}})},doApplyforGroup:function e(){var t=this;var a={offsetY:80};this.$http.post("/apply_for_group/",{group_id:this.applyForGroup.groupId}).then(function(e){a.message=e.message;if(e.result){a.theme="success";for(var i in t.availableApplyGroups){if(t.availableApplyGroups[i].id===t.applyForGroup.groupId){t.availableApplyGroups.splice(i,1);break}}t.applyForGroup.dialogVisible=false}else{a.theme="error"}t.$bkMessage(a)})},addDailyTemplate:function e(){var t=this;console.log("addDailyTemplateData:",this.addDailyTemplateData.formData);this.$http.post("/report_template/"+this.curGroup.id+"/",this.addDailyTemplateData.formData).then(function(e){var a={};a.offsetY=80;if(e.result){a.message=e.message;a.theme="success";t.$bkMessage(a);t.getGroupTemplates(t.curGroup.id);t.addDailyTemplateDialog.visible=false;t.addDailyTemplateData.formData={name:"",content:""}}else{a.message=e.message;a.theme="error";t.$bkMessage(a)}})},editDailyTemplate:function e(){var t=this;console.log("editDailyTemplateData",this.editDailyTemplateData);this.$http.put("/report_template/"+this.curGroup.id+"/",this.editDailyTemplateData.formData).then(function(e){var a={};a.offsetY=80;if(e.result){a.message=e.message;a.theme="success";t.$bkMessage(a);t.editDailyTemplateDialog.visible=false}else{a.message=e.message;a.theme="error";t.$bkMessage(a)}t.$http.get("/report_template/"+t.curGroup.id+"/").then(function(e){t.dailyTemplates=e.data;console.log("get_report_templates:",e.data)})})},removeDailyTemplate:function e(t){var a=this;var i=t.id;this.$http.delete("/report_template/"+this.curGroup.id+"/?template_id="+i,{template_id:12}).then(function(e){var t={};t.offsetY=80;t.message=e.message;if(e.result){t.theme="success";a.$bkMessage(t)}else{t.theme="error";a.$bkMessage(t)}a.$http.get("/report_template/"+a.curGroup.id+"/").then(function(e){a.dailyTemplates=e.data;console.log("get_report_templates:",e.data)})})},addUser:function e(){var t=this;var a=this;this.bkUsers.forEach(function(e){if(e.id===a.addUserForm.id){a.addUserForm=e}});console.log("addUserForm",this.addUserForm);this.$http.post("/add_user/"+this.curGroup.id+"/",this.addUserForm).then(function(e){var a={};a.offsetY=80;a.message=e.message;if(e.result){t.addUserDialog.visible=false;a.theme="success";t.$bkMessage(a);t.addUserForm={};t.getGroupUsers(t.curGroup.id)}else{a.theme="error";t.$bkMessage(a)}})},removeUser:function e(t){var a=this;if(this.curGroup.admin.indexOf(t.username)!==-1){var i={};i.offsetY=80;i.message="不可移除管理员，可通过编辑组信息修改";i.theme="error";this.$bkMessage(i)}else{console.log("row-user",t);var r={user_id:t.id};this.$http.post("/exit_group/"+this.curGroup.id+"/",r).then(function(e){var t={};t.offsetY=80;t.message=e.message;if(e.result){a.getGroupUsers(a.curGroup.id);t.theme="success";a.$bkMessage(t)}else{t.theme="error";a.$bkMessage(t)}})}}}};t.default=o},94:function(e,t,a){}}]);